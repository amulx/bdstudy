<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>自动触发配置事例：</title>
</head>
<body>
<div id="wmd-preview" class="wmd-preview"><div class="md-section-divider"></div><p data-anchor-id="7rvj">xdebug的配置</p><p data-anchor-id="3z5b"><code>xdebug</code> <code>php调试</code></p><hr><div class="md-section-divider"></div><h3 data-anchor-id="39dc" id="自动触发配置事例">自动触发配置事例：</h3><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="0kci"><ol class="linenums"><li class="L0"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">auto_trace </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span></code></li><li class="L1"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">trace_format </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span></code></li><li class="L2"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">trace_output_dir</span><span class="pun">=</span><span class="str">"D:\phpStudy\tmp\xdebug"</span></code></li><li class="L3"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">trace_options </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span></code></li><li class="L4"><code><span class="pun">;以</span><span class="pln">$_SERVER</span><span class="pun">[</span><span class="str">'REQUEST_URI'</span><span class="pun">]这个</span><span class="pln">URI</span><span class="pun">部分命名</span></code></li><li class="L5"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">trace_output_name </span><span class="pun">=</span><span class="pln"> </span><span class="str">"%R"</span></code></li><li class="L6"><code><span class="pun">;记录函数参数</span></code></li><li class="L7"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">collect_params </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4</span></code></li><li class="L8"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">collect_return </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span></code></li><li class="L9"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">collect_vars </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span></code></li><li class="L0"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">collect_assignments </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">profiler_append </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span></code></li><li class="L3"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">profiler_enable </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span></code></li><li class="L4"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">profiler_enable_trigger </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span></code></li><li class="L5"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">profiler_output_dir</span><span class="pun">=</span><span class="str">"D:\phpStudy\tmp\xdebug"</span></code></li><li class="L6"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">profiler_output_name </span><span class="pun">=</span><span class="pln"> </span><span class="str">"cache.out.%t-%s"</span></code></li><li class="L7"><code></code></li><li class="L8"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">remote_enable </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span></code></li><li class="L9"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">remote_handler </span><span class="pun">=</span><span class="pln"> </span><span class="str">"dbgp"</span></code></li><li class="L0"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">remote_host </span><span class="pun">=</span><span class="pln"> </span><span class="str">"127.0.0.1"</span></code></li><li class="L1"><code><span class="pln">zend_extension</span><span class="pun">=</span><span class="str">"D:\phpStudy\php\php-5.4.45\ext\php_xdebug.dll"</span></code></li></ol></pre><div class="md-section-divider"></div><h3 data-anchor-id="wnml" id="请求参数触发配置事例">请求参数触发配置事例</h3><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="7n30"><ol class="linenums"><li class="L0"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">auto_trace</span><span class="pun">=</span><span class="pln">off</span></code></li><li class="L1"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">trace_enable_trigger</span><span class="pun">=</span><span class="pln">on</span></code></li><li class="L2"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">trace_format </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span></code></li><li class="L3"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">trace_output_dir</span><span class="pun">=</span><span class="str">"D:\phpStudy\tmp\xdebug"</span></code></li><li class="L4"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">trace_options </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span></code></li><li class="L5"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">trace_output_name </span><span class="pun">=</span><span class="pln"> </span><span class="str">"%R"</span></code></li><li class="L6"><code></code></li><li class="L7"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">collect_params </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4</span></code></li><li class="L8"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">collect_return </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span></code></li><li class="L9"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">collect_vars </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span></code></li><li class="L0"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">collect_assignments </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span></code></li><li class="L1"><code></code></li><li class="L2"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">profiler_append </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span></code></li><li class="L3"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">profiler_enable </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span></code></li><li class="L4"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">profiler_enable_trigger </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span></code></li><li class="L5"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">profiler_output_dir</span><span class="pun">=</span><span class="str">"D:\phpStudy\tmp\xdebug"</span></code></li><li class="L6"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">profiler_output_name </span><span class="pun">=</span><span class="pln"> </span><span class="str">"cache.out.%t-%s"</span></code></li><li class="L7"><code></code></li><li class="L8"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">remote_enable </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span></code></li><li class="L9"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">remote_handler </span><span class="pun">=</span><span class="pln"> </span><span class="str">"dbgp"</span></code></li><li class="L0"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">remote_host </span><span class="pun">=</span><span class="pln"> </span><span class="str">"127.0.0.1"</span></code></li><li class="L1"><code><span class="pln">zend_extension</span><span class="pun">=</span><span class="str">"D:\phpStudy\php\php-5.4.45\ext\php_xdebug.dll"</span></code></li></ol></pre><p data-anchor-id="ix4l">需要在参数后面追加\XDEBUG_TRACE\参数</p><div class="md-section-divider"></div><h3 data-anchor-id="yybr" id="函数触发">函数触发</h3><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="y48w"><ol class="linenums"><li class="L0"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">auto_trace </span><span class="pun">=</span><span class="pln"> off</span></code></li><li class="L1"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">trace_format </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span></code></li><li class="L2"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">trace_output_dir</span><span class="pun">=</span><span class="str">"D:\phpStudy\tmp\xdebug"</span></code></li><li class="L3"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">trace_options </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span></code></li><li class="L4"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">trace_output_name </span><span class="pun">=</span><span class="pln"> </span><span class="str">"%R"</span></code></li><li class="L5"><code></code></li><li class="L6"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">collect_params </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4</span></code></li><li class="L7"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">collect_return </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span></code></li><li class="L8"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">collect_vars </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span></code></li><li class="L9"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">collect_assignments </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span></code></li><li class="L0"><code></code></li><li class="L1"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">profiler_append </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span></code></li><li class="L2"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">profiler_enable </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span></code></li><li class="L3"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">profiler_enable_trigger </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span></code></li><li class="L4"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">profiler_output_dir</span><span class="pun">=</span><span class="str">"D:\phpStudy\tmp\xdebug"</span></code></li><li class="L5"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">profiler_output_name </span><span class="pun">=</span><span class="pln"> </span><span class="str">"cache.out.%t-%s"</span></code></li><li class="L6"><code></code></li><li class="L7"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">remote_enable </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span></code></li><li class="L8"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">remote_handler </span><span class="pun">=</span><span class="pln"> </span><span class="str">"dbgp"</span></code></li><li class="L9"><code><span class="pln">xdebug</span><span class="pun">.</span><span class="pln">remote_host </span><span class="pun">=</span><span class="pln"> </span><span class="str">"127.0.0.1"</span></code></li><li class="L0"><code><span class="pln">zend_extension</span><span class="pun">=</span><span class="str">"D:\phpStudy\php\php-5.4.45\ext\php_xdebug.dll"</span></code></li></ol></pre><p data-anchor-id="dof4">然后找到你要开始追踪回溯的代码位置调用xdebug_start_trace函数,再在要停止追踪回溯的位置调用xdebug_stop_trace函数,这样就会生成回溯信息,并且是对你开始和结束trace函数之间的代码进行记录,其它无关的代码是不记录的:</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="6b7w"><ol class="linenums"><li class="L0"><code><span class="pln">$str </span><span class="pun">=</span><span class="pln"> </span><span class="str">'abc'</span><span class="pun">;</span></code></li><li class="L1"><code><span class="pln">$str1 </span><span class="pun">=</span><span class="pln"> substr</span><span class="pun">(</span><span class="pln">$str</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">);</span></code></li><li class="L2"><code><span class="pln">xx</span><span class="pun">(</span><span class="str">'a'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'b'</span><span class="pun">);</span></code></li><li class="L3"><code></code></li><li class="L4"><code><span class="kwd">function</span><span class="pln"> xx</span><span class="pun">(</span><span class="pln">$a</span><span class="pun">,</span><span class="pln"> $b</span><span class="pun">){</span></code></li><li class="L5"><code><span class="pln">    xdebug_start_trace</span><span class="pun">();</span><span class="pln"> </span><span class="com">//开始记录回溯</span></code></li><li class="L6"><code><span class="pln">    $x </span><span class="pun">=</span><span class="pln"> array</span><span class="pun">();</span></code></li><li class="L7"><code><span class="pln">	array_push</span><span class="pun">(</span><span class="pln">$x</span><span class="pun">,</span><span class="pln"> $a</span><span class="pun">);</span></code></li><li class="L8"><code><span class="pln">	</span><span class="kwd">print</span><span class="pun">(</span><span class="lit">222</span><span class="pun">);</span></code></li><li class="L9"><code><span class="pln">	array_push</span><span class="pun">(</span><span class="pln">$x</span><span class="pun">,</span><span class="pln"> $b</span><span class="pun">);</span></code></li><li class="L0"><code><span class="pln">	xdebug_stop_trace</span><span class="pun">();</span><span class="pln"> </span><span class="com">//结束记录回溯</span></code></li><li class="L1"><code><span class="pln">	yy</span><span class="pun">();</span></code></li><li class="L2"><code><span class="pln">	</span><span class="kwd">return</span><span class="pln"> $x</span><span class="pun">;</span></code></li><li class="L3"><code><span class="pun">}</span></code></li><li class="L4"><code></code></li><li class="L5"><code><span class="kwd">function</span><span class="pln"> yy</span><span class="pun">(){</span></code></li><li class="L6"><code><span class="pln">    print_r</span><span class="pun">(</span><span class="lit">123</span><span class="pun">);</span></code></li><li class="L7"><code><span class="pun">}</span></code></li></ol></pre><p data-anchor-id="76et">并且要注意,通过函数触发的话并不需要什么配置,你只要开启了扩展就可以,就是只保留zend_extension="xdebug.dll"就可以,其它xdebug的相关配置可以完全不配置,如果有文件名定制需求就再保留xdebug.trace_output_name选项就足够了</p><p data-anchor-id="2gof">然而如果你开启了xdebug.auto_trace其实相当于让PHP启动时就自动执行xdebug_start_trace函数,于是会报错说这个函数已经执行过了,所以为避免麻烦请不要开启xdebug_start_trace</p><p data-anchor-id="17ic">这个调试更加精准,因为如果整个运行周期都回溯下来,起码有成千上万行,查找成为了艰难的事情</p><p data-anchor-id="vse6">而函数触发时就缩小了你需要的范围,查找就快捷了很多!</p></div>
</body>
</html>